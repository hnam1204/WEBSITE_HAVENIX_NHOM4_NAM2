@model List<HV_NIX.Models.ShippingAddress>
@{
    ViewBag.Title = "Địa chỉ giao hàng";
    Layout = "~/Views/Shared/_Layout.cshtml";
}
<link rel="stylesheet" href="~/Content/account.css" />

<main class="account-main">
    @Html.Partial("_AccountSidebar")

    <section class="account-content">
        <!-- HEADER: TIÊU ĐỀ + NÚT THÊM -->
        <div class="page-header">
            <h2> Địa chỉ giao hàng</h2>
            <button class="btn-add" id="btnAddAddress">+ Thêm địa chỉ mới</button>
        </div>

        @if (!Model.Any())
        {
            <div class="empty-box">
                <p>⚠️ Bạn chưa có địa chỉ giao hàng nào.</p>
            </div>
        }
        else
        {
            foreach (var a in Model)
            {
                <div class="address-card @(a.IsDefault ? "default" : "")">
                    <div class="address-info">
                        <strong>@a.ReceiverName</strong> • @a.Phone <br />
                        <span>@a.AddressLine, @a.City</span>
                    </div>
                    <div class="address-actions">
                        <a href="@Url.Action("Edit", "Shipping", new { id = a.AddressID })" class="btn-small btn-edit">
                             Sửa
                        </a>

                        @if (!a.IsDefault)
                        {
                            <a href="@Url.Action("SetDefault", "Shipping", new { id = a.AddressID })" class="btn-small btn-default-set">
                                 Đặt mặc định
                            </a>
                        }
                        else
                        {
                            <span class="btn-small btn-default-active">✔ Mặc định</span>
                        }

                        <a href="@Url.Action("Delete", "Shipping", new { id = a.AddressID })"
                           class="btn-small danger btn-delete"
                           onclick="return confirm('Bạn có chắc muốn xóa địa chỉ này?');">
                             Xóa
                        </a>
                    </div>
                </div>
            }
        }
    </section>
</main>

<!-- MODAL THÊM ĐỊA CHỈ -->
<div id="modalAdd" class="modal-add">
    <div class="modal-content">
        <button class="btn-close" id="closeModal">×</button>
        <h3>➕ Thêm địa chỉ mới</h3>
        <form method="post" action="@Url.Action("Add", "Shipping")">
            @Html.AntiForgeryToken()

            <label>Họ tên người nhận</label>
            <input type="text" name="name" required class="form-control" />

            <label>Số điện thoại</label>
            <input type="text" name="phone" required class="form-control" />

            <label>Địa chỉ chi tiết</label>
            <input type="text" name="address" required class="form-control" />

            <label>Thành phố / Tỉnh</label>
            <input type="text" name="city" required class="form-control" />

            <input type="hidden" name="isDefault" value="false" />
            <label class="checkbox-label">
                <input type="checkbox" name="isDefault" value="true" />
                Đặt làm địa chỉ mặc định
            </label>

            <button type="submit" class="btn-primary">Lưu địa chỉ</button>
        </form>
    </div>
</div>

<script>
    const modal = document.getElementById('modalAdd');
    document.getElementById('btnAddAddress').onclick = () => modal.classList.add('active');
    document.getElementById('closeModal').onclick = () => modal.classList.remove('active');
    window.onclick = e => { if (e.target === modal) modal.classList.remove('active'); };
</script>
<style>
    /* ==================================================
   FULL ACCOUNT.CSS - ĐÃ FIX 100% LỖI, ĐẸP LUNG LINH 2025
   - Tiêu đề căn giữa + nút thêm căn phải
   - Nút bo tròn xanh cyan
   - Thông báo trống căn giữa, chữ xám nhạt, khung dashed
   - Card thanh toán, địa chỉ, thông báo, hồ sơ... đồng bộ
   - Modal mượt, responsive hoàn hảo
================================================== */
body {
    background: linear-gradient(135deg, #e0f7fa, #b2ebf2);
    min-height: 100vh;
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    margin: 0;
}

/* Layout chính */
.account-main {
    max-width: 1180px;
    margin: 40px auto;
    display: flex;
    gap: 30px;
    padding: 0 20px;
}

/* Nội dung */
.account-content {
    flex: 1;
    background: white;
    padding: 40px;
    border-radius: 20px;
    box-shadow: 0 10px 40px rgba(0,0,0,0.1);
}

/* Header: tiêu đề căn giữa + nút thêm căn phải */
.page-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 50px;
}
.page-header h2 {
    margin: 0;
    font-size: 28px;
    color: #006064;
    font-weight: 700;
    flex: 1;
    text-align: center;
}

/* Nút thêm - bo tròn xanh cyan */
.btn-add, #btnAdd, #btnAddAddress {
    padding: 11px 26px;
    background: #00acc1;
    color: white;
    border: none;
    border-radius: 50px;
    font-size: 15.5px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    box-shadow: 0 4px 15px rgba(0,172,193,0.3);
}
.btn-add:hover, #btnAdd:hover, #btnAddAddress:hover {
    background: #00838f;
    transform: translateY(-2px);
    box-shadow: 0 8px 25px rgba(0,172,193,0.4);
}

/* Khi trống - giống hệt hình */
.empty-box, .empty-state {
    text-align: center;
    padding: 80px 20px;
    background: #f8fdfe;
    border: 2px dashed #b2ebf2;
    border-radius: 20px;
    margin-top: 30px;
}
.empty-box p, .empty-state p {
    font-size: 17px;
    color: #888;
    margin: 0;
    font-weight: 500;
}

/* Card địa chỉ / thanh toán */
.address-card, .payment-card {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 22px 26px;
    background: white;
    border: 2.5px solid #e0f7fa;
    border-radius: 18px;
    margin-bottom: 18px;
    transition: all 0.3s ease;
    position: relative;
}
.address-card:hover, .payment-card:hover {
    box-shadow: 0 12px 35px rgba(0,172,193,0.25);
    transform: translateY(-4px);
}
.address-card.default, .payment-card.default {
    border-color: #00acc1;
    background: #e0f7fa;
}
.address-card.default::after, .payment-card.default::after {
    content: "Mặc định";
    position: absolute;
    top: -12px;
    left: 20px;
    background: #00acc1;
    color: white;
    font-size: 12px;
    font-weight: 700;
    padding: 4px 14px;
    border-radius: 20px;
}

/* Bên trái */
.address-info, .payment-left {
    display: flex;
    align-items: center;
    gap: 22px;
}
.payment-icon {
    font-size: 36px;
    width: 72px;
    height: 72px;
    display: flex;
    align-items: center;
    justify-content: center;
    background: #f1fcfd;
    border: 2px solid #b2ebf2;
    border-radius: 20px;
}
.bank-icon { color: #006064; }
.momo-icon { color: #d81b60; }
.cash-icon { color: #43a047; }

.address-info strong, .payment-info .method-name {
    font-size: 19px;
    font-weight: 600;
    color: #006064;
    margin: 0 0 8px 0;
}
.address-info span, .payment-info .type {
    font-size: 14.5px;
    color: #777;
}
.account-number {
    margin-top: 8px;
    color: #444;
    font-size: 16px;
}
.account-number b { color: #006064; font-weight: 600; }

.badge-default {
    background: #00acc1;
    color: white;
    padding: 6px 16px;
    font-size: 13px;
    font-weight: 700;
    border-radius: 50px;
    margin-top: 10px;
    display: inline-block;
}

/* Nút hành động */
.address-actions, .payment-actions {
    display: flex;
    gap: 14px;
    flex-wrap: wrap;
}
.btn-small, .btn-action {
    padding: 10px 22px;
    border-radius: 50px;
    font-size: 14.5px;
    font-weight: 600;
    text-decoration: none;
    transition: all 0.25s ease;
}
.btn-small.btn-edit, .btn-action.edit {
    background: #e3f2fd;
    color: #1565c0;
    border: 2px solid #90caf9;
}
.btn-small.btn-edit:hover, .btn-action.edit:hover { background: #bbdefb; }
.btn-small.btn-default-set, .btn-action.set-default {
    background: #fff3e0;
    color: #e65100;
    border: 2px solid #ffcc80;
}
.btn-small.btn-default-set:hover, .btn-action.set-default:hover { background: #ffe0b2; }
.btn-small.danger, .btn-action.delete {
    background: #ffebee;
    color: #c62828;
    border: 2px solid #ef9a9a;
}
.btn-small.danger:hover, .btn-action.delete:hover { background: #ffcdd2; }
.btn-small.btn-default-active {
    background: #e8f5e9;
    color: #2e7d32;
    border: 2px solid #a5d6a7;
    cursor: default;
}

/* Modal */
.modal-add {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.5);
    z-index: 1000;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(8px);
}
.modal-add.active { display: flex; }

.modal-content {
    background: white;
    width: 90%;
    max-width: 580px;
    padding: 45px;
    border-radius: 24px;
    box-shadow: 0 25px 80px rgba(0,0,0,0.28);
    position: relative;
    animation: modalShow 0.4s ease-out;
}
@@keyframes modalShow {
    from { opacity: 0; transform: translateY(-70px) scale(0.92); }
    to   { opacity: 1; transform: translateY(0) scale(1); }
}
.modal-content h3 {
    margin: 0 0 32px;
    text-align: center;
    font-size: 26px;
    color: #006064;
}

/* Form */
.form-control, select.form-control {
    width: 100%;
    padding: 17px 20px;
    border: 2px solid #b2ebf2;
    border-radius: 16px;
    background: #f8fdfe;
    font-size: 17px;
    margin-bottom: 20px;
    transition: all 0.3s ease;
}
.form-control:focus, select.form-control:focus {
    outline: none;
    border-color: #00acc1;
    background: white;
    box-shadow: 0 0 0 6px rgba(0,172,193,0.22);
}
select.form-control {
    appearance: none;
    background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='%2300acc1'%3e%3cpath d='M7 10l5 5 5-5z'/%3e%3c/svg%3e");
    background-repeat: no-repeat;
    background-position: right 20px center;
    background-size: 20px;
}

/* Checkbox */
.checkbox-label {
    display: flex;
    align-items: center;
    gap: 14px;
    margin-top: 24px;
    cursor: pointer;
    font-size: 16px;
}
.checkbox-label input[type="checkbox"] {
    width: 24px;
    height: 24px;
    accent-color: #00acc1;
}

/* Nút đóng */
.btn-close {
    position: absolute;
    top: 18px;
    right: 24px;
    background: none;
    border: none;
    font-size: 34px;
    color: #bbb;
    cursor: pointer;
}
.btn-close:hover { color: #333; }

/* Responsive */
@@media (max-width: 768px) {
    .account-main { flex-direction: column; }
    .page-header { flex-direction: column; gap: 20px; text-align: center; }
    .page-header h2 { order: 2; }
    .btn-add { order: 1; }
    .address-card, .payment-card {
        flex-direction: column;
        align-items: flex-start;
        gap: 22px;
    }
    .address-actions, .payment-actions { width: 100%; justify-content: stretch; }
    .btn-small, .btn-action { flex: 1; text-align: center; }
}
</style>